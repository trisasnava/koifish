name: Rust

on:
  release:
    types:
      - created

jobs:
  rust_publish:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2
      - name: Package
        run: cargo package --verbose
      - name: Run tests
        run: cargo test --verbose
      - name: Publish to crates-io
        run:  cargo publish --token  ${{secrets.PUBLISH_KEY}} --verbose
